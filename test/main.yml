---
- name: Test playbook
  hosts: test

  vars_files:
    - private.yml

  vars:
    smb_shares:
      - name: file_share
        comment: private file share
        path: /share/file-share
        writable: "yes"
        browsable: "yes"
        inherit_permissions: "yes"
        force_user: mountuser
        force_group: mountuser

      - name: video_share
        comment: private video share
        path: /share/video-share
        writable: "yes"
        browsable: "yes"
        inherit_permissions: "yes"
        force_user: mountuser
        force_group: mountuser

    lighttpd_rules:
      - |
        url.rewrite-once = (
          "^/(dist|images|api)/(.*)$" =>      "/$1/$2",
          "^/robots.txt$"             =>      "/robots.txt",
          ".*"                        =>      "/"
        )
      - |
        url.redirect = (
          "^/(projects)$"             =>      "/index.html"
        )

    dashboard_address: 192.168.1.102
    host_wireguard_address: 10.6.0.1/32

  roles:
    # - {role: upgrade_packages}
    # - {role: start_containers, role_container_ids: [ 101, 102, 103 ]}
    # - {role: ssh_configure, role_authorized_keys: "{{ authorized_keys }}"}
    # - {role: lighttpd, role_git_source: "{{ portfolio_git }}", role_website_name: "{{ portfolio_name }}", role_server_ip: 192.168.1.106, role_server_address: "{{ portfolio_address }}", role_server_rules: "{{ lighttpd_rules }}" }
    # - {role: username.rolename, role_dashboard_address: {{ dashboard_address }}, role_dashboard_password: {{ wireguard_dashboard_password }}, role_host_wireguard_address: {{ host_wireguard_address }}, role_wireguard_peers: {{ wireguard_peers }}, role_wireguard_private_key: "{{ wireguard_private_key }}" }
    # - { role: username.rolename, role_nordvpn_username: {{ nordvpn_username }}, role_nordvpn_password: {{ nordvpn_password }}, role_nordvpn_server: nl900.nordvpn.com.udp1194 }

    # - {role: username.rolename, role_ip_address: 192.168.1.101, role_admin_password: "{{ pihole_password }}"}
    # - {role: samba_configure, role_smb_password: "{{ smb_password }}", role_smb_shares: "{{ smb_shares }}"}
    # - {role: git_configure, role_git_name: Tycho Brouwer, role_git_email: tycho.tbrouwer@gmail.com}

